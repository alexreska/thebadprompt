# Supabase Setup Guide for "The Bad Prompt" v2.0

Follow these steps to configure your backend.

## 1. Create a Project
1.  Go to [Supabase.com](https://supabase.com) and Sign In.
2.  Click **"New Project"**.
3.  Choose your organization, give it a name (e.g., `TheBadPrompt-v2`), and generate a strong password.
4.  Select a region close to you effectively (e.g., EU West or US East).
5.  Click **"Create new project"**.
6.  *Wait a few minutes for the database to provision.*

## 2. Get Your Credentials (URL & Key)
1.  Once the dashboard loads, look for the **"Project API"** section on the Home page, or go to **Settings (Gear Icon) -> API**.
2.  Copy the **Project URL**.
3.  Copy the **`anon` / `public` Key**.
4.  **Save these!** You will paste them into `lib/core/app_constants.dart`.

## 3. Database Setup (SQL Editor)
We need to create the tables that the App expects.
1.  Go to the **SQL Editor** (icon on the left sidebar looking like a terminal `>_`).
2.  Click **"New Query"**.
3.  **Paste and Run** the following SQL script:

```sql
-- 1. Create Table: SESSIONS
create table public.sessions (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  status text default 'active', -- 'active', 'voting', 'finished'
  start_time timestamp with time zone default timezone('utc'::text, now())
);

-- 2. Create Table: FRAGMENTS
create table public.fragments (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  session_id bigint references public.sessions(id),
  user_id uuid, -- Linked to auth.users if we wanted, or just as a string ID
  content text not null,
  author_name text
);

-- 3. Enable Realtime
alter publication supabase_realtime add table public.sessions;
alter publication supabase_realtime add table public.fragments;

-- 4. Create Initial Active Session (So the app works immediately)
insert into public.sessions (status, start_time) values ('active', now());
```

## 4. Setup Authentication (Anonymous)
1.  Go to **Authentication** (sidebar icon).
2.  Click **Providers**.
3.  Find **Anonymous Sign-Ins** and toggle it **ON**.
4.  Click **Save**.

## 5. Disable RLS (For Beta Testing Only)
To avoid permission errors while testing rapidly (WARNING: Not secure for production):
1.  Go to **Table Editor**.
2.  For both `sessions` and `fragments`:
    *   Click on the table name.
    *   Click "RLS is enabled" (green shield?) -> **Disable RLS**.
    *   Confirm.
*(Alternatively, create policies allowing `SELECT` and `INSERT` for everyone).*

## 6. Done!
Now go back to your Flutter code:
1.  Open `lib/core/app_constants.dart`.
2.  Replace the placeholders with your URL and Key.
3.  Run the app!
